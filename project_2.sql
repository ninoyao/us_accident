DROP DATABASE IF EXISTS loan;

CREATE DATABASE loan;

USE loan;

set session net_read_timeout=3600;

CREATE TABLE master_table(
id VARCHAR(100),
member_id VARCHAR(100),
loan_amnt VARCHAR(100),
funded_amnt VARCHAR(100),
funded_amnt_inv VARCHAR(100),
term VARCHAR(100),
int_rate VARCHAR(100),
installment VARCHAR(100),
grade VARCHAR(100),
sub_grade VARCHAR(100),
emp_title VARCHAR(100),
emp_length VARCHAR(100),
home_ownership VARCHAR(100),
annual_inc VARCHAR(100),
verification_status VARCHAR(100),
issue_d VARCHAR(100),
loan_status VARCHAR(100),
pymnt_plan VARCHAR(100),
url VARCHAR(100),
purpose VARCHAR(100),
title VARCHAR(100),
zip_code VARCHAR(100),
addr_state VARCHAR(100),
dti VARCHAR(100),
delinq_2yrs VARCHAR(100),
earliest_cr_line VARCHAR(100),
inq_last_6mths VARCHAR(100),
mths_since_last_delinq VARCHAR(100),
mths_since_last_record VARCHAR(100),
open_acc VARCHAR(100),
pub_rec VARCHAR(100),
revol_bal VARCHAR(100),
revol_util VARCHAR(100),
total_acc VARCHAR(100),
initial_list_status VARCHAR(100),
out_prncp VARCHAR(100),
out_prncp_inv VARCHAR(100),
total_pymnt VARCHAR(100),
total_pymnt_inv VARCHAR(100),
total_rec_prncp VARCHAR(100),
total_rec_int VARCHAR(100),
total_rec_late_fee VARCHAR(100),
recoveries VARCHAR(100),
collection_recovery_fee VARCHAR(100),
last_pymnt_d VARCHAR(100),
last_pymnt_amnt VARCHAR(100),
next_pymnt_d VARCHAR(100),
last_credit_pull_d VARCHAR(100),
collections_12_mths_ex_med VARCHAR(100),
mths_since_last_major_derog VARCHAR(100),
policy_code VARCHAR(100),
application_type VARCHAR(100),
annual_inc_joint VARCHAR(100),
dti_joint VARCHAR(100),
verification_status_joint VARCHAR(100),
acc_now_delinq VARCHAR(100),
tot_coll_amt VARCHAR(100),
tot_cur_bal VARCHAR(100),
open_acc_6m VARCHAR(100),
open_act_il VARCHAR(100),
open_il_12m VARCHAR(100),
open_il_24m VARCHAR(100),
mths_since_rcnt_il VARCHAR(100),
total_bal_il VARCHAR(100),
il_util VARCHAR(100),
open_rv_12m VARCHAR(100),
open_rv_24m VARCHAR(100),
max_bal_bc VARCHAR(100),
all_util VARCHAR(100),
total_rev_hi_lim VARCHAR(100),
inq_fi VARCHAR(100),
total_cu_tl VARCHAR(100),
inq_last_12m VARCHAR(100),
acc_open_past_24mths VARCHAR(100),
avg_cur_bal VARCHAR(100),
bc_open_to_buy VARCHAR(100),
bc_util VARCHAR(100),
chargeoff_within_12_mths VARCHAR(100),
delinq_amnt VARCHAR(100),
mo_sin_old_il_acct VARCHAR(100),
mo_sin_old_rev_tl_op VARCHAR(100),
mo_sin_rcnt_rev_tl_op VARCHAR(100),
mo_sin_rcnt_tl VARCHAR(100),
mort_acc VARCHAR(100),
mths_since_recent_bc VARCHAR(100),
mths_since_recent_bc_dlq VARCHAR(100),
mths_since_recent_inq VARCHAR(100),
mths_since_recent_revol_delinq VARCHAR(100),
num_accts_ever_120_pd VARCHAR(100),
num_actv_bc_tl VARCHAR(100),
num_actv_rev_tl VARCHAR(100),
num_bc_sats VARCHAR(100),
num_bc_tl VARCHAR(100),
num_il_tl VARCHAR(100),
num_op_rev_tl VARCHAR(100),
num_rev_accts VARCHAR(100),
num_rev_tl_bal_gt_0 VARCHAR(100),
num_sats VARCHAR(100),
num_tl_120dpd_2m VARCHAR(100),
num_tl_30dpd VARCHAR(100),
num_tl_90g_dpd_24m VARCHAR(100),
num_tl_op_past_12m VARCHAR(100),
pct_tl_nvr_dlq VARCHAR(100),
percent_bc_gt_75 VARCHAR(100),
pub_rec_bankruptcies VARCHAR(100),
tax_liens VARCHAR(100),
tot_hi_cred_lim VARCHAR(100),
total_bal_ex_mort VARCHAR(100),
total_bc_limit VARCHAR(100),
total_il_high_credit_limit VARCHAR(100),
revol_bal_joint VARCHAR(100),
sec_app_earliest_cr_line VARCHAR(100),
sec_app_inq_last_6mths VARCHAR(100),
sec_app_mort_acc VARCHAR(100),
sec_app_open_acc VARCHAR(100),
sec_app_revol_util VARCHAR(100),
sec_app_open_act_il VARCHAR(100),
sec_app_num_rev_accts VARCHAR(100),
sec_app_chargeoff_within_12_mths VARCHAR(100),
sec_app_collections_12_mths_ex_med VARCHAR(100),
sec_app_mths_since_last_major_derog VARCHAR(100),
hardship_flag VARCHAR(100),
hardship_type VARCHAR(100),
hardship_reason VARCHAR(100),
hardship_status VARCHAR(100),
deferral_term VARCHAR(100),
hardship_amount VARCHAR(100),
hardship_start_date VARCHAR(100),
hardship_end_date VARCHAR(100),
payment_plan_start_date VARCHAR(100),
hardship_length VARCHAR(100),
hardship_dpd VARCHAR(100),
hardship_loan_status VARCHAR(100), 
orig_projected_additional_accrued_interest VARCHAR(100),
hardship_payoff_balance_amount VARCHAR(100),
hardship_last_payment_amount VARCHAR(100),
disbursement_method VARCHAR(100),
debt_settlement_flag VARCHAR(100),
debt_settlement_flag_date VARCHAR(100),
settlement_status VARCHAR(100),
settlement_date VARCHAR(100),
settlement_amount VARCHAR(100),
settlement_percentage VARCHAR(100),
settlement_term VARCHAR(100)
);

LOAD DATA INFILE 'C:\\Users\\ninoy\\Desktop\\VandyDS\\2020spring\\dbms\\Lending_club\\data\\loan_500k.csv'
INTO TABLE master_table
FIELDS TERMINATED BY ","
OPTIONALLY ENCLOSED BY '"'
ESCAPED BY '"'
LINES TERMINATED BY '$'; 


select * from master_table;